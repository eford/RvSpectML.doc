<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · RvSpectML.jl</title><link rel="canonical" href="https://eford.github.io/RvSpectML.jl/internals.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>RvSpectML.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li class="current"><a class="toctext" href="internals.html">Internals</a><ul class="internal"><li class="toplevel"><a class="toctext" href="#Internals-Types-and-Functions-1">Internals Types &amp; Functions</a></li><li><a class="toctext" href="#General-purpose-1">General purpose</a></li><li><a class="toctext" href="#Radial-Velocity-Related-1">Radial Velocity Related</a></li><li><a class="toctext" href="#Interpolation-1">Interpolation</a></li><li><a class="toctext" href="#Instrument-specific-1">Instrument specific</a></li></ul></li><li><a class="toctext" href="longlist.html">Index</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="internals.html">Internals</a></li></ul><a class="edit-page" href="https://github.com/eford/RvSpectML.jl/blob/master/docs/src/internals.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Internals</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="RvSpectML-1" href="#RvSpectML-1">RvSpectML</a></h1><h1><a class="nav-anchor" id="Internals-Types-and-Functions-1" href="#Internals-Types-and-Functions-1">Internals Types &amp; Functions</a></h1><ul><li><a href="index.html#RvSpectML-1">RvSpectML</a></li><ul><li><a href="index.html#Modules-1">Modules</a></li><li><a href="index.html#Exported-Functions-1">Exported Functions</a></li><li><a href="index.html#Exported-Types-1">Exported Types</a></li></ul><li><a href="internals.html#RvSpectML-1">RvSpectML</a></li><li><a href="internals.html#Internals-Types-and-Functions-1">Internals Types &amp; Functions</a></li><ul><li><a href="internals.html#General-purpose-1">General purpose</a></li><li><a href="internals.html#Radial-Velocity-Related-1">Radial Velocity Related</a></li><li><a href="internals.html#Interpolation-1">Interpolation</a></li><li><a href="internals.html#Instrument-specific-1">Instrument specific</a></li></ul><li><a href="longlist.html#Index-1">Index</a></li></ul><h2><a class="nav-anchor" id="General-purpose-1" href="#General-purpose-1">General purpose</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.ChunkWidthFuncOfλ" href="#RvSpectML.ChunkWidthFuncOfλ"><code>RvSpectML.ChunkWidthFuncOfλ</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Functor to return a scale factor for chunk widths that depends on the chunk&#39;s central wavelength.</p><p><strong>TODO: Replace with something useful, e.g., uses actual PSF behavior as function of wavelength</strong></p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/instruments/masks.jl#LL18-L22">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.getindex-Union{Tuple{CLT}, Tuple{CLT,Any}} where CLT&lt;:AbstractChunkList" href="#Base.getindex-Union{Tuple{CLT}, Tuple{CLT,Any}} where CLT&lt;:AbstractChunkList"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Allow direct access to data, an AbstractArray of ChunkOfSpectrum&#39;s via [] operator </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/types/chunks.jl#LL78">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.setindex!-Union{Tuple{CLT}, Tuple{CLT,Any,CLT}} where CLT&lt;:AbstractChunkList" href="#Base.setindex!-Union{Tuple{CLT}, Tuple{CLT,Any,CLT}} where CLT&lt;:AbstractChunkList"><code>Base.setindex!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Allow direct access to data, an AbstractArray of ChunkOfSpectrum&#39;s via [] operator </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/types/chunks.jl#LL83">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.allequal-Union{Tuple{AbstractArray{T,1}}, Tuple{T}} where T&lt;:Real" href="#RvSpectML.allequal-Union{Tuple{AbstractArray{T,1}}, Tuple{T}} where T&lt;:Real"><code>RvSpectML.allequal</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Return true if all elements of array are equal to each other. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/util.jl#LL105">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.bin_times-Union{Tuple{AT}, Tuple{T}, Tuple{AbstractSpectralTimeSeriesCommonWavelengths,AT,Integer}} where AT&lt;:AbstractArray{T,1} where T&lt;:Real" href="#RvSpectML.bin_times-Union{Tuple{AT}, Tuple{T}, Tuple{AbstractSpectralTimeSeriesCommonWavelengths,AT,Integer}} where AT&lt;:AbstractArray{T,1} where T&lt;:Real"><code>RvSpectML.bin_times</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>bin<em>times() Bins times from a SpectralTimeSeriesCommonWavelengths object using the groupings from time</em>idx in the metadata.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/combine_obs.jl#LL208-L211">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.calc_d2fluxdlnlambda2!-Union{Tuple{T3}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T1,1},AbstractArray{T2,1}}} where T3&lt;:Real where T2&lt;:Real where T1&lt;:Real" href="#RvSpectML.calc_d2fluxdlnlambda2!-Union{Tuple{T3}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T1,1},AbstractArray{T2,1}}} where T3&lt;:Real where T2&lt;:Real where T1&lt;:Real"><code>RvSpectML.calc_d2fluxdlnlambda2!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Estimate numerical second derivative of fluxes given wavelengths. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/project_flux.jl#LL52">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.calc_dfluxdlnlambda!-Union{Tuple{T3}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T2,1},AbstractArray{T3,1}}} where T3&lt;:Real where T2&lt;:Real where T1&lt;:Real" href="#RvSpectML.calc_dfluxdlnlambda!-Union{Tuple{T3}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T2,1},AbstractArray{T3,1}}} where T3&lt;:Real where T2&lt;:Real where T1&lt;:Real"><code>RvSpectML.calc_dfluxdlnlambda!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Estimate numerical derivative of fluxes given wavelengths. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/project_flux.jl#LL26">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.calc_snr-Union{Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,N} where N,AbstractArray{T2,N} where N}} where T2&lt;:Real where T1&lt;:Real" href="#RvSpectML.calc_snr-Union{Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,N} where N,AbstractArray{T2,N} where N}} where T2&lt;:Real where T1&lt;:Real"><code>RvSpectML.calc_snr</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Calculate total SNR in (region of) spectra. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/spectra.jl#LL49">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.find_cols_to_fit-Union{Tuple{T}, Tuple{AbstractArray{T,1},Real,Real}} where T&lt;:Real" href="#RvSpectML.find_cols_to_fit-Union{Tuple{T}, Tuple{AbstractArray{T,1},Real,Real}} where T&lt;:Real"><code>RvSpectML.find_cols_to_fit</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Return a range of columns indices with wavelengths between line<em>lo and line</em>hi </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/chunks.jl#LL129">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.find_cols_to_fit-Union{Tuple{T}, Tuple{AbstractArray{T,1},Real}} where T&lt;:Real" href="#RvSpectML.find_cols_to_fit-Union{Tuple{T}, Tuple{AbstractArray{T,1},Real}} where T&lt;:Real"><code>RvSpectML.find_cols_to_fit</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Return a range of columns indices with wavelengths within Δ of line_center </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/chunks.jl#LL123">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.find_line_best" href="#RvSpectML.find_line_best"><code>RvSpectML.find_line_best</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Return (pixels, order) pair that contain &quot;best&quot; region of spectra, based on highest SNR. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/chunks.jl#LL228">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.find_orders_with_line-Union{Tuple{T}, Tuple{Real,AbstractArray{T,2}}} where T&lt;:Real" href="#RvSpectML.find_orders_with_line-Union{Tuple{T}, Tuple{Real,AbstractArray{T,2}}} where T&lt;:Real"><code>RvSpectML.find_orders_with_line</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Return list of all orders that contain a pixel with wavelength lambda </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/chunks.jl#LL135">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.find_orders_with_line-Union{Tuple{T}, Tuple{Real,Real,AbstractArray{T,2}}} where T&lt;:Real" href="#RvSpectML.find_orders_with_line-Union{Tuple{T}, Tuple{Real,Real,AbstractArray{T,2}}} where T&lt;:Real"><code>RvSpectML.find_orders_with_line</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Return list of all orders that contain all pixels with wavelengths between goal<em>lo and goal</em>hi </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/chunks.jl#LL146">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.findall_line" href="#RvSpectML.findall_line"><code>RvSpectML.findall_line</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Return list of (pixels, order) pairs that contain pixels with desireed wavelengths.     Excludes locations that contain any pixels with var == NaN.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/chunks.jl#LL153-L156">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.findargminmax-Tuple{Any}" href="#RvSpectML.findargminmax-Tuple{Any}"><code>RvSpectML.findargminmax</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>findargminmax(a) Return (argmin, min, argmax, max) Adapapted from https://github.com/JuliaLang/julia/blob/697e782ab86bfcdd7fd15550241fe162c51d9f98/base/array.jl#L2191</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/util.jl#LL117-L121">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.get_λs-Union{Tuple{AR}, Tuple{V1}, Tuple{T1}, Tuple{V1,AR}} where AR&lt;:AbstractUnitRange where V1&lt;:AbstractArray{T1,1} where T1&lt;:AbstractRange" href="#RvSpectML.get_λs-Union{Tuple{AR}, Tuple{V1}, Tuple{T1}, Tuple{V1,AR}} where AR&lt;:AbstractUnitRange where V1&lt;:AbstractArray{T1,1} where T1&lt;:AbstractRange"><code>RvSpectML.get_λs</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>&quot; get_λs( grids::Vector{AbstractRange}, r::AbstractUnitRange ) Return range of wavelengths corresponding to indices in r from a vector of ranges. Useful for extracting wavelengths from a chunklist.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/plots.jl#LL36-L40">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.interp_chunk_to_shifted_grid_linear!-Union{Tuple{AR}, Tuple{AC}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T2,1},AC,AR,Real}} where AR&lt;:Union{AbstractArray{T2,1}, AbstractRange} where AC&lt;:AbstractChuckOfSpectrum where T2&lt;:Real where T1&lt;:Real" href="#RvSpectML.interp_chunk_to_shifted_grid_linear!-Union{Tuple{AR}, Tuple{AC}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T2,1},AC,AR,Real}} where AR&lt;:Union{AbstractArray{T2,1}, AbstractRange} where AC&lt;:AbstractChuckOfSpectrum where T2&lt;:Real where T1&lt;:Real"><code>RvSpectML.interp_chunk_to_shifted_grid_linear!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>interp<em>chunk</em>to<em>grid</em>linear!( flux<em>out, var</em>out, chunk<em>of</em>spectrum, wavelengths ) Return spectra interpolated onto a grid of points using linear interpolation.</p><p><strong>Arguments:</strong></p><ul><li>flux_out::AbstractArray</li><li>var_out::AbstractArray</li><li>chunk::AbstractChunkOfSpectrum</li><li>grid::AbstractRange or AbstractArray</li></ul><p><strong>Alters</strong></p><ul><li>flux_out</li><li>var_out::AbstractArray</li></ul><p><strong>Returns</strong></p><ul><li>flux_out</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/interp/interp.jl#LL31-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.interp_chunk_to_shifted_grid_sinc!-Union{Tuple{AR}, Tuple{AC}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T2,1},AC,AR,Real}} where AR&lt;:Union{AbstractArray{T2,1}, AbstractRange} where AC&lt;:AbstractChuckOfSpectrum where T2&lt;:Real where T1&lt;:Real" href="#RvSpectML.interp_chunk_to_shifted_grid_sinc!-Union{Tuple{AR}, Tuple{AC}, Tuple{T2}, Tuple{T1}, Tuple{AbstractArray{T1,1},AbstractArray{T2,1},AC,AR,Real}} where AR&lt;:Union{AbstractArray{T2,1}, AbstractRange} where AC&lt;:AbstractChuckOfSpectrum where T2&lt;:Real where T1&lt;:Real"><code>RvSpectML.interp_chunk_to_shifted_grid_sinc!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>interp<em>chunk</em>to<em>grid</em>sinc!( flux<em>out, var</em>out, chunk<em>of</em>spectrum, wavelengths ) Return spectra interpolated onto a grid of points using sinc interpolation.</p><p><strong>Arguments:</strong></p><ul><li>flux_out::AbstractArray</li><li>var_out::AbstractArray</li><li>chunk::AbstractChunkOfSpectrum</li><li>grid::AbstractRange or AbstractArray</li></ul><p><strong>Alters</strong></p><ul><li>flux_out</li><li>var_out::AbstractArray</li></ul><p><strong>Returns</strong></p><ul><li>flux_out</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/interp/interp.jl#LL83-L96">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.make_template_spectra-Union{Tuple{ACLT}, Tuple{ACLT}} where ACLT&lt;:AbstractChunkListTimeseries" href="#RvSpectML.make_template_spectra-Union{Tuple{ACLT}, Tuple{ACLT}} where ACLT&lt;:AbstractChunkListTimeseries"><code>RvSpectML.make_template_spectra</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>make<em>template</em>spectra( chunk<em>list</em>timeseries, [ options ] ) Combine portions of spectra in a ChunkListTimeseries into a template stored as a SpectralTimeSeriesCommonWavelengths. Optionally remove radial velocities before combining spectra based on the :rv_est field in metadata.</p><p><strong>Inputs:</strong></p><ul><li>chunk<em>list</em>timeseries</li></ul><p><strong>Optional Parametes:</strong></p><ul><li>remove<em>rv</em>est (true)</li><li>oversample_factor (1)</li><li>smooth_factor (1)</li><li>alg (:TemporalGP)</li></ul><p><strong>Outputs</strong></p><ul><li>matrix:  timeseries interpolated to each wavelength in the form of a SpectralTimeSeriesCommonWavelengths</li><li>f_mean:  mean flux</li><li>var_mean: variance of mean flux (WARNING: Not computed accurately yet)</li><li>deriv:  dflux/dlnλ averaged over spectra</li><li>deriv2: d²flux/dlnλ² averaged over spectra</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/combine_obs.jl#LL9-L26">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.multiple_append!-Union{Tuple{T}, Tuple{Array{T,1},Vararg{Any,N} where N}} where T&lt;:Real" href="#RvSpectML.multiple_append!-Union{Tuple{T}, Tuple{Array{T,1},Vararg{Any,N} where N}} where T&lt;:Real"><code>RvSpectML.multiple_append!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>A generalized version of the built in append!() function By Christian Gilbertson?</p><p><strong>TODO:  Ask Christian what the purpose of this is relative to std append</strong></p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/util.jl#LL94-L98">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.normalize_spectra!-Union{Tuple{AS}, Tuple{ST}, Tuple{ACLT}, Tuple{ACLT,AS}} where AS&lt;:(AbstractArray{ST,N} where N) where ST&lt;:AbstractSpectra where ACLT&lt;:AbstractChunkListTimeseries" href="#RvSpectML.normalize_spectra!-Union{Tuple{AS}, Tuple{ST}, Tuple{ACLT}, Tuple{ACLT,AS}} where AS&lt;:(AbstractArray{ST,N} where N) where ST&lt;:AbstractSpectra where ACLT&lt;:AbstractChunkListTimeseries"><code>RvSpectML.normalize_spectra!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Normalize each spectrum based on sum of fluxes in chunk_timeseries region of each spectrum. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/spectra.jl#LL77">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.predict_intrinsic_stellar_line_width-Tuple{Real}" href="#RvSpectML.predict_intrinsic_stellar_line_width-Tuple{Real}"><code>RvSpectML.predict_intrinsic_stellar_line_width</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Estimate line width based on stellar Teff (K) and optionally v_rot (km/s).  Output in km/s.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/util.jl#LL31-L33">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.read_metradata_from_fits" href="#RvSpectML.read_metradata_from_fits"><code>RvSpectML.read_metradata_from_fits</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Read metadata in FITS header and return data for keys in fields_str/fields as a Dict. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/instruments/io.jl#LL31">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.searchsortednearest" href="#RvSpectML.searchsortednearest"><code>RvSpectML.searchsortednearest</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>searchsortednearest(a&lt;:AbstractVector, x::Real; assume<em>sorted = false )    searchsortednearest(a&lt;:AbstractVector, x&lt;:AbstractVector; assume</em>sorted = false )</p><p>Find the index of vector a where the value of a is closest to x.    All vectors are assumed to already be sorted.      To turn off assertions, set assume_sorted to true.</p><p>Credit: traktofon @ https://discourse.julialang.org/t/findnearest-function/4143/4 Vector Vector version by Christian Gilbertson? issorted assertion and optional assume_sorted added by Eric Ford</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/util/util.jl#LL42-L53">source</a></section><h2><a class="nav-anchor" id="Radial-Velocity-Related-1" href="#Radial-Velocity-Related-1">Radial Velocity Related</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.length-Tuple{RvSpectML.CCF.AbstractLineList}" href="#Base.length-Tuple{RvSpectML.CCF.AbstractLineList}"><code>Base.length</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Return length of line linst. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/ccf/line_list.jl#LL45">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.CCF.calc_doppler_factor-Tuple{Real}" href="#RvSpectML.CCF.calc_doppler_factor-Tuple{Real}"><code>RvSpectML.CCF.calc_doppler_factor</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">calc_doppler_factor(vel)</code></pre><p>Compute the longitudinal relativistic doppler factor given a velocity in meters per second.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/ccf/calc_ccf.jl#LL182-L187">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.CCF.calc_order_ccf_chunklist_timeseries-Union{Tuple{AbstractChunkListTimeseries}, Tuple{PlanT}, Tuple{AbstractChunkListTimeseries,PlanT}} where PlanT&lt;:RvSpectML.CCF.AbstractCCFPlan" href="#RvSpectML.CCF.calc_order_ccf_chunklist_timeseries-Union{Tuple{AbstractChunkListTimeseries}, Tuple{PlanT}, Tuple{AbstractChunkListTimeseries,PlanT}} where PlanT&lt;:RvSpectML.CCF.AbstractCCFPlan"><code>RvSpectML.CCF.calc_order_ccf_chunklist_timeseries</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>calc<em>ccf</em>chunk( chunklist<em>timeseries, line</em>list ) Convenience function to compute separate CCFs for each chunk of each spectrum in a timeseries. CCF is evaluated using mask_shape and plan. Uses multiple threads if avaliable.</p><p><strong>Inputs:</strong></p><ul><li>chunklist_timeseries</li><li>line_list</li></ul><p><strong>Optional Arguments:</strong></p><ul><li>mask_shape (TopHatCCFMask())</li><li>ccf_plan (BasicCCFPlan())</li></ul><p><strong>Return:</strong></p><p>A 3-d array containing the CCF at each (velocity, chunk, spectrum)</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/ccf/convenience.jl#LL91-L104">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.CCF.calc_order_ccfs_chunklist-Union{Tuple{AbstractChunkList}, Tuple{PlanT}, Tuple{AbstractChunkList,PlanT}} where PlanT&lt;:RvSpectML.CCF.AbstractCCFPlan" href="#RvSpectML.CCF.calc_order_ccfs_chunklist-Union{Tuple{AbstractChunkList}, Tuple{PlanT}, Tuple{AbstractChunkList,PlanT}} where PlanT&lt;:RvSpectML.CCF.AbstractCCFPlan"><code>RvSpectML.CCF.calc_order_ccfs_chunklist</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>calc<em>ccf</em>chunk( chunklist<em>timeseries, line</em>list ) Convenience function to compute separate CCFs for each chunk in a spectrum. CCF evaluated using mask_shape and plan.</p><p><strong>Inputs:</strong></p><ul><li>chunklist_timeseries</li><li>line_list</li></ul><p><strong>Optional Arguments:</strong></p><ul><li>mask_shape (TopHatCCFMask())</li><li>ccf_plan (BasicCCFPlan())</li></ul><p><strong>Return:</strong></p><p>A 2-d array containing the CCF at each (velocity, chunk)</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/ccf/convenience.jl#LL71-L83">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.CCF.find_bin_edges_opt-Union{Tuple{A}, Tuple{A}, Tuple{T}} where A&lt;:AbstractArray{T,1} where T&lt;:Real" href="#RvSpectML.CCF.find_bin_edges_opt-Union{Tuple{A}, Tuple{A}, Tuple{T}} where A&lt;:AbstractArray{T,1} where T&lt;:Real"><code>RvSpectML.CCF.find_bin_edges_opt</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>find<em>bin</em>edges( pixel_centers )</p><p>Internal function used by project_mask!. TODO: OPT may be able to eliminate need for this memory allocation.  Or at least preallocate it.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/ccf/calc_ccf.jl#LL202-L207">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.CCF.project_mask_opt!-Union{Tuple{PlanT}, Tuple{A3}, Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A2,A1,PlanT}} where PlanT&lt;:RvSpectML.CCF.AbstractCCFPlan where A3&lt;:AbstractArray{T1,1} where A2&lt;:AbstractArray{T2,2} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real" href="#RvSpectML.CCF.project_mask_opt!-Union{Tuple{PlanT}, Tuple{A3}, Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A2,A1,PlanT}} where PlanT&lt;:RvSpectML.CCF.AbstractCCFPlan where A3&lt;:AbstractArray{T1,1} where A2&lt;:AbstractArray{T2,2} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real"><code>RvSpectML.CCF.project_mask_opt!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">project_mask!( output, λs, line_list; shift_factor, mask_shape )</code></pre><p>Compute the projection of the mask onto the 1D array of wavelengths (λs) at a given shift factor (default: 1). The mask is computed from a line<em>list and mask</em>shape (default: tophat).</p><p>TODO: Implement/test other mask_shapes.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/ccf/calc_ccf.jl#LL84-L91">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.RVFromCCF.measure_rv-Union{Tuple{A3}, Tuple{T3}, Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2,A3}} where A3&lt;:AbstractArray{T3,2} where T3&lt;:Real where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real" href="#RvSpectML.RVFromCCF.measure_rv-Union{Tuple{A3}, Tuple{T3}, Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2,A3}} where A3&lt;:AbstractArray{T3,2} where T3&lt;:Real where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real"><code>RvSpectML.RVFromCCF.measure_rv</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">measure_rv(wavs, spec, mask; fit_type=&quot;gaussian&quot;)

TODO: Need to update for CCF refactoring.</code></pre><p>Compute the cross correlation function and fit to calculate a velocity using the specified method. Valid arguments for fit_type include &quot;gaussian&quot;, &quot;quadratic&quot;, and &quot;centroid&quot;.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/ccf_std.jl#LL22-L31">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.RVFromCCF.prelim_fit-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real" href="#RvSpectML.RVFromCCF.prelim_fit-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real"><code>RvSpectML.RVFromCCF.prelim_fit</code></a> — <span class="docstring-category">Method</span>.</div><div><div></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/ccf_std.jl#LL110-L112">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.RVFromCCF.rv_from_ccf_bestfit-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real" href="#RvSpectML.RVFromCCF.rv_from_ccf_bestfit-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real"><code>RvSpectML.RVFromCCF.rv_from_ccf_bestfit</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Report RV based on minimum of CCF WARNING:  This is highly pixelated and should be used for special purposes (e.g., initial guesses).</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/ccf_std.jl#LL187-L190">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.RVFromCCF.rv_from_ccf_centroid-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real" href="#RvSpectML.RVFromCCF.rv_from_ccf_centroid-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real"><code>RvSpectML.RVFromCCF.rv_from_ccf_centroid</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Report RV based on centroid near minimum of CCF. WARNING:  Something&#39;s fishy with these.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/ccf_std.jl#LL176-L179">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.RVFromCCF.rv_from_ccf_gaussian-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real" href="#RvSpectML.RVFromCCF.rv_from_ccf_gaussian-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real"><code>RvSpectML.RVFromCCF.rv_from_ccf_gaussian</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Report RV base don fit Gaussian near minimum of CCF.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/ccf_std.jl#LL157-L159">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.RVFromCCF.rv_from_ccf_quadratic-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real" href="#RvSpectML.RVFromCCF.rv_from_ccf_quadratic-Union{Tuple{A2}, Tuple{T2}, Tuple{A1}, Tuple{T1}, Tuple{A1,A2}} where A2&lt;:AbstractArray{T2,1} where T2&lt;:Real where A1&lt;:AbstractArray{T1,1} where T1&lt;:Real"><code>RvSpectML.RVFromCCF.rv_from_ccf_quadratic</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Report RV based on fitting quadratic near minimum of CCF.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/calc_rv/ccf_std.jl#LL138-L140">source</a></section><h2><a class="nav-anchor" id="Interpolation-1" href="#Interpolation-1">Interpolation</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.SincInterpolation.create_filter_curve_orig-Tuple{Int64}" href="#RvSpectML.SincInterpolation.create_filter_curve_orig-Tuple{Int64}"><code>RvSpectML.SincInterpolation.create_filter_curve_orig</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Original author: Joe Ninan Converted to Julia and optimized by Christian Gilbertson &amp; Eric Ford Returns a cubit interpolator for windowed sinc Filter curve. no<em>of</em>points: number of intepolation points to use in cubic inteprolator</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/alg/interp/sinc.jl#LL21-L26">source</a></section><h2><a class="nav-anchor" id="Instrument-specific-1" href="#Instrument-specific-1">Instrument specific</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.EXPRES.make_manifest-Tuple{String}" href="#RvSpectML.EXPRES.make_manifest-Tuple{String}"><code>RvSpectML.EXPRES.make_manifest</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Create Dataframe containing filenames and key data for all files neid*.fits in directory</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/instruments/expres/io.jl#LL14">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.EXPRES.read_metadata-Tuple{String}" href="#RvSpectML.EXPRES.read_metadata-Tuple{String}"><code>RvSpectML.EXPRES.read_metadata</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Create Dict containing filename and default metadata from file.</p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/instruments/expres/io.jl#LL34">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RvSpectML.NEID.read_differential_extinctions!" href="#RvSpectML.NEID.read_differential_extinctions!"><code>RvSpectML.NEID.read_differential_extinctions!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Read space delimited file with differential extinction corrections, interpolate to bjd&#39;s in df and insert into df[:,diff<em>ext</em>rv]. </p></div></div><a class="source-link" target="_blank" href="https://github.com/eford/RvSpectML.jl/blob/161a77f5ea10553a5f5106e42bdcfe90619abc83/src/instruments/neid/io.jl#LL116">source</a></section><footer><hr/><a class="previous" href="index.html"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="longlist.html"><span class="direction">Next</span><span class="title">Index</span></a></footer></article></body></html>
